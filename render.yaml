services:
  # Janus Gateway - OpenAI-compatible proxy
  - type: web
    name: janus-gateway
    runtime: python
    plan: free
    region: oregon
    branch: main
    rootDir: gateway
    buildCommand: pip install -e .
    startCommand: uvicorn janus_gateway.main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: PYTHON_VERSION
        value: "3.11"
      - key: JANUS_DEBUG
        value: "false"
      - key: JANUS_LOG_FORMAT
        value: "json"
      - key: BASELINE_URL
        fromService:
          type: web
          name: janus-baseline-agent-cli
          property: hostport
          envVarKey: BASELINE_URL
      - key: BASELINE_LANGCHAIN_URL
        fromService:
          type: web
          name: janus-baseline-langchain
          property: hostport
          envVarKey: BASELINE_LANGCHAIN_URL
    healthCheckPath: /health

  # Janus Baseline Agent CLI - Reference competitor implementation
  - type: web
    name: janus-baseline-agent-cli
    runtime: python
    plan: free
    region: oregon
    branch: main
    rootDir: baseline-agent-cli
    buildCommand: pip install -e .
    startCommand: uvicorn janus_baseline_agent_cli.main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: PYTHON_VERSION
        value: "3.11"
      - key: BASELINE_AGENT_CLI_DEBUG
        value: "false"
      - key: BASELINE_AGENT_CLI_OPENAI_API_KEY
        sync: false
      - key: SANDY_BASE_URL
        value: "https://sandy.65.109.64.180.nip.io"
      - key: SANDY_API_KEY
        sync: false
      - key: CHUTES_API_KEY
        sync: false
    healthCheckPath: /health

  # Janus Baseline LangChain - Alternative competitor implementation
  - type: web
    name: janus-baseline-langchain
    runtime: python
    plan: free
    region: oregon
    branch: main
    rootDir: baseline-langchain
    buildCommand: pip install -e .
    startCommand: uvicorn janus_baseline_langchain.main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: PYTHON_VERSION
        value: "3.11"
      - key: BASELINE_LANGCHAIN_DEBUG
        value: "false"
      - key: BASELINE_LANGCHAIN_OPENAI_API_KEY
        sync: false
      - key: BASELINE_LANGCHAIN_CHUTES_API_KEY
        sync: false
      - key: BASELINE_LANGCHAIN_TAVILY_API_KEY
        sync: false
    healthCheckPath: /health

  # Janus Chat UI - Next.js frontend
  - type: web
    name: janus-ui
    runtime: node
    plan: free
    region: oregon
    branch: main
    rootDir: ui
    buildCommand: npm install && npm run build
    startCommand: npm run start -- --port $PORT
    envVars:
      - key: NODE_VERSION
        value: "20"
      - key: NEXT_PUBLIC_GATEWAY_URL
        fromService:
          type: web
          name: janus-gateway
          property: host
          envVarKey: NEXT_PUBLIC_GATEWAY_URL
    healthCheckPath: /
